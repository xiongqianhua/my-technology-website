# HTTP1.1  HTTP2.0  HTTP3.0
       我记得第一次去面试的时候，被面试官问到，http和https的区别是什么，我很爽快的回答出了（明文传输和加密传输，端口号80和443等），继续问道在哪一层我也很爽快的回答出了（应用层），然后面试官又紧追不舍的问，你知道http/1，http/2，http/3的区别是什么么？请分别简述一下它们的原理，然后我语言没办法清晰组织了，说的自己都理不清楚。。。心里虽然觉得这不是事，但真的有条理说出来让大家都懂，确实要整理一番，毕竟逃不过大佬的火眼金睛，不然面试结果可能就是：菜鸡一个，鉴定完毕！！！

 下面我来讨论讨论这三者的原理


在HTTP1.1中是默认开启了Keep-Alive，虽然解决了多次连接的问题，但是依然有两个比较严重的问题：
* 串行传输：在单通道传输的前提下，假设要传输10个文件，那么只能依次逐个传输，传输完第一个再传输第二个，以此类推；
* 连接数问题：HTTP/1.1 虽然默认开启keep-alive可以复用一部分连接，但域名分片等情况下仍然需要建立多个connection，耗费资源，给服务器带来性能压力。


http2采用二进制格式传输数据，而非 HTTP 1.x 的文本格式，二进制协议解析起来更高效。 HTTP / 1 的请求和响应报文，都是由起始行，首部和实体正文（可选）组成，各部分之间以文本换行符分隔。HTTP/2 将请求和响应数据分割为更小的帧，并且它们采用二进制编码。HTTP/2 中，同域名下所有通信都在单个连接上完成，该连接可以承载任意数量的双向数据流。每个数据流都以消息的形式发送，而消息又由一个或多个帧组成。多个帧之间可以乱序发送，根据帧首部的流标识可以重新组装。


在 HTTP/2 中
* 同域名下所有通信都在单个连接上完成
* 单个连接可以承载任意数量的双向数据流
* 数据流以消息的形式发送，而消息又由一个或多个帧组成，多个帧之间可以乱序发送，因为根据帧首部的流标识可以重新组装。


这一特性，使性能有了极大提升：
* 同个域名只需要占用一个 TCP 连接，使用一个连接并行发送多个请求和响应,消除了因多个 TCP 连接而带来的延时和内存消耗
* 并行交错地发送多个请求和响应，两两之间互不影响
* 在 HTTP/2 中，每个请求都可以带一个 31bit 的优先值，0 表示最高优先级， 数值越大优先级越低。有了这个优先值，客户端和服务器就可以在处理不同的流时采取不同的策略，以最优的方式发送流、消息和帧。

# 2.1 二进制分帧
# 2.2 首部压缩（header compression）
# 2.3 服务器推送（server push）
# 2.4 多路复用
# 3 HTTP2协商机制


HTTP3如何工作
* 我们回想一下HTTPS，HTTPS是类似于TCP握手的工作方式，先工作在HTTP1上，通过HTTP1传递交换得到秘钥，然后切换到HTTPS上工作。
* 接着我们回想一下HTTP2，HTTP2也是基于TLS的，所以HTTP2的工作方式和HTTPS也是同样的过程，需要握手建立TLS连接，只是TLS连接完成后，发送一个HTTP2的连接确认消息，确认后，客户端服务器使用HTTP2进行连接通讯。
* 最后让我们看下HTTP3如何工作。首先要建立好HTTP2连接，然后发送HTTP2扩展帧，这个帧包含IP和端口，浏览器收到扩展帧，使用该IP和端口，使用QUIC建立连接，如果成功，断开HTTP2，升级为HTTP3。

￼

HTTP2和HTTP3的传输层是完全不同的协议，HTTP3的传输层是UDP协议。我们知道UDP协议是个不可靠的协议，而TCP协议是可靠协议，怎样保证可靠的呢，重传。




